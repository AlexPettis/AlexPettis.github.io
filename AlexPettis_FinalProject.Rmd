---
title: "Forecasting Nike's Annual Revenue"
subtitle: "ECO 5740 - Forecasting and Time Series Models (Fall 2023)"
author: "Alex Pettis"
date: "updated: `r Sys.Date()`"
output:
  xaringan::moon_reader:
    seal: true
    # lib_dir: libs
    css: [appstate.css, appstate-fonts.css]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      titleSlideClass: [top, right, inverse]
      # autoplay: 40000
      # countdown: 30000
execute:
  echo: false
  warning: false
  message: false
  cache: true
format:
  revealjs:
    self-contained: true

number-sections: true
toc: true
toc-depth: 3
lof: true
lot: true
fig-cap-location: bottom
---


```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(fpp3) 
library(readr) # for reading csv files
library(readxl) # for reading excel files

# Please refrain from using any other libraries for this project unless it is absolutely required. 
```

# Introduction

  * Time Series Forecasting:
    * Predicting Nike's future annual revenue based on historical sales data (1988-2023).

  * Project Goals:
    * Accurately predict Nike's future revenue trends using the best forecasting model.

  * Practical Importance:
    * Crucial for informed decisions in resource allocation, strategic planning, and talent acquisition at Nike. Helps devise effective business strategies amidst uncertainties.

```{r, eval = TRUE, echo = FALSE}
# Bring my xlsx file from download to R and call it mydata
mydata <- read_xlsx("statistic_id888676_us-revenue-of-nike-from-1988-to-2023.xlsx")

# Convert the "Year" column to Date format
mydata$Year <- as.Date(mydata$Year, format = "%Y")

# Extract the year from the "Year" column and set up data as a time series object
mydata <- mydata |>
  mutate(Year = year(Year)) |>
  as_tsibble(index = Year)

```

---

# Dataset

  * Overview: Nike's annual revenue dataset (1988-2023) depicts the company's financial performance.
  
  * Time Range: Annual revenue data from 1988 to 2023.
  
  * Key Characteristics:
    * Illustrates Nike's revenue trends in billions of dollars.
    * Upward trajectory observed with notable fluctuations.
    * Notable surge in revenue from 2015 to 2020, indicating growth phases.
    * Lack of significant autocorrelation, resembling characteristics of white noise as per statistical tests.
---

#  Data Exploration

```{r, warning = FALSE, message = FALSE, echo = FALSE, fig.width = 3, fig.height = 3.5, out.width = '50%', fig.show = 'hold'}
 mydata |>
  autoplot() +
  ggtitle("Nike Reveune Graph") + 
  xlab("Year") + 
  ylab("Revenue in billion U.S. dollars")

autoplot(ACF(mydata)) +
  ggtitle("Nike Revenue ACF Plot") +
  ylab("ACF")
```
* Trend is the only pattern we see in the data

---
# Model Training and Selection

```{r, eval = TRUE, echo = FALSE}
# extract the training set to fit the data
training_set <- mydata |>
  filter_index("1988" ~ "2016") 

# extract the test set  
test_set <- mydata |>
  filter_index("2017" ~ "2023") 

# set the forecast horizon equals to the test set
h <- nrow(test_set)
```

* Training Set: 1988 to 2016

* Explored fundamental benchmarks like average, naive, and drift models.

* Chose drift model as initial benchmark due to RMSE of 1652.515, setting a baseline for comparison.

* Employed a diverse set of advanced models (regression, Holt, Holt-Damped, ETS, SES, theta, ARIMA, dynamic regression, neural networks).

* Tested each model using a separate test set, calculating RMSE for accuracy comparison against the Drift model, aiming to enhance forecasting precision.
---

# Accuracy Evaluation

* RMSE and MASE used for model accuracy comparison.

* Drift model RMSE: 1652.51533, MASE: 2.07986064.

* Drift model emerged as most accurate for Nike's revenue forecast.

* Observed deviations from expected normal distribution.

* Residuals centered around zero, resembling white noise.

* Minimal autocorrelation seen in ACF plot.

* Ljung-Box test p-value: 0.3990961, lacking significant autocorrelation.
---

# Forecast and Insights

```{r, echo  = FALSE, fig.width = 7, fig.height = 6}

# Fit the model of your choice
my_fit <- mydata |> # notice you are using the complete data here, not the training set
  model(
    Drift = NAIVE(Revenue ~ drift()) # your preferred method could differ.
)

# Now, use the fitted model to forecast for the next h periods.

my_fit |>
  forecast(h = h) |>
  autoplot(mydata) + 
  labs(title = "Nike Revenue Forecast using Drift Method", x = "Year", y = "Revenue in billion U.S. dollars")
```
* 2030 Revenue should be about $26 billion


---

# Challenges and Limitations


* Market Instability and Post-COVID Demand are challenges

* Adaptive Planning and Market Diversification are strategies to overcome

* Enhanced Forecasting Techniques and more variables could help improve the forecast

* Ensemble methods (Drift, Dynamic Regression, ARIMA, and Holt Damped)
---

# Conclusion

* Forecasting:

  * Drift Model Accuracy: Drift model most accurate for Nike's revenue prediction.
  * Robustness: Residual deviations resemble to white noise, suitable for forecasting.

* Challenges & Solutions:

  * Challenges: Market instability and post-COVID demand slowdown.
  * Solutions: Adaptive planning, diversification, enhanced forecasting.

* Significance:

  * Business Impact: Accurate forecasts support resource allocation and strategic planning.
  * Navigating Uncertainties: Insights crucial amidst market instabilities and post-pandemic fluctuations.

---

# Questions 

* Are there any questions?